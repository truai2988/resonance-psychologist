<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>お申し込み | 寄りSOMAR - 心理カウンセリングのご予約</title>
    <meta name="description" content="寄りSOMARの心理カウンセリングお申し込みフォームです。オリエンテーションセッション、場のセッション、コンディショニング朗読のご予約を承ります。">
    <meta name="robots" content="noindex, nofollow">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon.png">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://yori-somaru.com/apply.html">
</head>

<body>
    <header>
        <div class="logo"><a href="/" style="text-decoration: none; color: inherit;">寄りSOMAR</a></div>
    </header>

    <main class="container page-content" style="padding-top: 15vw;">
        <div id="form-container">
            <h1 class="section-title">お申し込み</h1>
            <p style="text-align: center; margin-bottom: 40px; color: var(--c-text-muted);">
                セッションをご希望の方は、以下のフォームより必要事項を入力し、送信してください。<br>
                通常2営業日以内に、日程調整のご連絡を差し上げます。
            </p>

            <form id="apply-form" class="card legal-section" style="max-width: 800px; margin: 0 auto;">
                <div class="form-group">
                    <label for="name">お名前 <span class="required">*</span></label>
                    <input type="text" id="name" name="name" required placeholder="山田 太郎">
                </div>

                <div class="form-group">
                    <label for="furigana">フリガナ <span class="required">*</span></label>
                    <input type="text" id="furigana" name="furigana" required placeholder="ヤマダ タロウ">
                </div>

                <div class="form-group">
                    <label for="email">メールアドレス <span class="required">*</span></label>
                    <input type="email" id="email" name="email" required placeholder="example@mail.com">
                </div>

                <div class="form-group">
                    <label for="service">お申し込みの種別 <span class="required">*</span></label>
                    <select id="service" name="service" required>
                        <option value="" disabled selected>選択してください</option>
                        <option value="orientation">オリエンテーションセッション (¥25,000 / 90min)</option>
                        <option value="field">場のセッション (¥15,000 / 60min)</option>
                        <option value="reading">コンディショニング朗読 (¥5,000 / 30min)</option>
                        <option value="inquiry">その他・お問い合わせ</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="schedule">ご希望の曜日・時間帯など</label>
                    <textarea id="schedule" name="schedule" rows="3"
                        placeholder="例：平日の午後、週末の午前中など。いくつか候補をいただけますと、日程調整がスムーズです。"></textarea>
                </div>

                <div class="form-group">
                    <label for="message">メッセージ本文 <span class="required">*</span></label>
                    <textarea id="message" name="message" rows="6" required
                        placeholder="セッションで話してみたいと感じるテーマや、今の想いをお聞かせください。"></textarea>
                </div>

                <div style="text-align: center; margin-top: 40px;">
                    <button type="submit" class="btn-primary"
                        style="width: 100%; max-width: 400px; display: flex; align-items: center; justify-content: center; gap: 10px; margin: 0 auto;">
                        <span>送信する</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="22" y1="2" x2="11" y2="13"></line>
                            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                        </svg>
                    </button>
                    <p style="font-size: 0.8rem; color: var(--c-text-muted); margin-top: 15px;">
                        送信前に <a href="/privacy.html" target="_blank">プライバシーポリシー</a> をご確認ください。
                    </p>
                </div>
            </form>
        </div>

        <div id="success-container" style="display: none; text-align: center; padding: 100px 20px;">
            <div style="font-size: 4rem; margin-bottom: 20px;">✉️</div>
            <h2 class="section-title">お手続き、ありがとうございました。</h2>
            <p style="margin-bottom: 40px; line-height: 1.8;">
                お申し込み内容を送信いたしました。<br>
                2営業日以内に、玉置より日程調整のメールをお送りします。<br>
                恐れ入りますが、しばらくお待ちください。
            </p>
            <a href="/" class="btn-small">トップページへ戻る</a>
        </div>
    </main>

    <footer>
        <div class="container">
            <p style="font-size: 0.8rem; color: var(--c-text-muted);">&copy; 2025 Resonance Practitioner | 合同会社カイシュウ</p>
        </div>
    </footer>

    <script type="module">
        const form = document.getElementById('apply-form');
        const formContainer = document.getElementById('form-container');
        const successContainer = document.getElementById('success-container');
        const submitBtn = form.querySelector('button[type="submit"]');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            // UI state: loading
            submitBtn.disabled = true;
            submitBtn.style.opacity = '0.7';
            submitBtn.querySelector('span').innerText = '送信中...';

            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            try {
                // Formspree is the easiest API for static forms.
                // Replace with your Formspree ID if you have one.
                const response = await fetch('https://formspree.io/f/xlgrrwal', {
                    method: 'POST',
                    body: JSON.stringify(data),
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    formContainer.style.display = 'none';
                    successContainer.style.display = 'block';
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                } else {
                    const errorData = await response.json();
                    alert('送信に失敗しました: ' + (errorData.error || '不明なエラー'));
                    submitBtn.disabled = false;
                    submitBtn.style.opacity = '1';
                    submitBtn.querySelector('span').innerText = '送信する';
                }
            } catch (error) {
                alert('通信エラーが発生しました。インターネット接続を確認してください。');
                submitBtn.disabled = false;
                submitBtn.style.opacity = '1';
                submitBtn.querySelector('span').innerText = '送信する';
            }
        });
    </script>
    <script type="module" src="/src/main.ts"></script>
</body>

</html>